<!DOCTYPE html>
<html>

        <head>
                <meta charset="utf-8">
                <meta http-equiv="X-UA-Compatible" content="IE=edge">
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <title>Blog - Free Bulma template</title>
                <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon.png">
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
                <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/overlayscrollbars/1.9.1/css/OverlayScrollbars.min.css'>
                <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
                <!-- Bulma Version 0.9.0-->




                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.2/css/bulma.min.css"/>
                <link rel="stylesheet" type="text/css" href="./css/blog.css">
        </head>

        <body>
                <nav class="navbar">
                        <div class="container">
                                <div class="navbar-brand">
                                        <a class="navbar-item" href="../">
                                                <img src="./images/bulma.png" alt="Logo">
                                        </a>
                                        <span class="navbar-burger burger" data-target="navbarMenu">
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                        </span>
                                </div>
                                <div id="navbarMenu" class="navbar-menu">
                                        <div class="navbar-end">
                                                <a class="navbar-item is-active">
                                                        Home
                                                </a>
                                                <a class="navbar-item">
                                                        Examples
                                                </a>
                                                <a class="navbar-item">
                                                        Features
                                                </a>
                                                <a class="navbar-item">
                                                        Team
                                                </a>
                                                <a class="navbar-item">
                                                        Archives
                                                </a>
                                                <a class="navbar-item">
                                                        Help
                                                </a>
                                                <div class="navbar-item has-dropdown is-hoverable">
                                                        <a class="navbar-link">
                                                                Account
                                                        </a>
                                                        <div class="navbar-dropdown">
                                                                <a class="navbar-item">
                                                                        Dashboard
                                                                </a>
                                                                <a class="navbar-item">
                                                                        Profile
                                                                </a>
                                                                <a class="navbar-item">
                                                                        Settings
                                                                </a>
                                                                <hr class="navbar-divider">
                                                                <div class="navbar-item">
                                                                        Logout
                                                                </div>
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </nav>
                <!-- END NAV -->

                <section class="hero is-info is-medium is-bold">
                        <div class="hero-body">
                                <div class="container has-text-centered">
                                        <div class="title is-1">Private Pangenomics</div>
                                        <h2 class="subtitle">Making genomic data accessible with strong privacy garanties</h2>
                                </div>
                        </div>
                </section>





                <div class="container">
                        <!-- START ARTICLE FEED -->
                        <section class="articles">
                                <div class="column is-8 is-offset-2">
                                        <!-- START ARTICLE -->
                                        <div class="card article">
                                                <div class="card-content">
                                                        <div class="media">
                                                                <div class="media-content has-text-centered">
                                                                        <p class="title article-title"></p>
                                                                        <div class="tags has-addons level-item">
                                                                                <span class="tag is-rounded is-info">@"@"heefoo</span>
                                                                                <span class="tag is-rounded">June 14, 2021</span>
                                                                        </div>
                                                                </div>
                                                        </div>

                                                        <div class="columns">
                                                                <div class="column">
                                                                        <div class="media-center">
                                                                                <img src="/static/images/dna.png" class="author-image" alt="Placeholder image">
                                                                        </div>

                                                                </div>

                                                                <div class="column">
                                                                        <div class="media-content has-text-centered">
                                                                                <div class="content article-body">
                                                                                        <h3 class="has-text-centered">About the Project</h3>
                                                                                        <p>There is an increasing need in science, medicine and many other contexts to selectively
                                                                                        aggregate and selectively share data across different sources while at the same time
                                                                                        preserving privacy of data sources where possible.
                                                                                        One way to attach this problem is through the usage of privacy-preserving
                                                                                        variation graphs, that allow to capture complex models and aggregate data
                                                                                        resources with formal privacy guarantees of the individual data
                                                                                        sources from which they were constructed.
                                                                                        </p>
                                                                                </div>
                                                                        </div>

                                                                </div>
                                                        </div>

                                                </div>
                                        </div>
                                        <!-- START ARTICLE -->
                                        <div class="card article">
                                                <div class="card-content">
                                                        <div class="media">
                                                                <div class="media-content has-text-centered">
                                                                        <p class="title article-title"></p>
                                                                        <div class="tags has-addons level-item">
                                                                                <span class="tag is-rounded is-info">@"@"heefoo</span>
                                                                                <span class="tag is-rounded">May 10, 2021</span>
                                                                        </div>
                                                                </div>
                                                        </div>

                                                        <div class="columns">
                                                                <div class="column">
                                                                        <div class="content article-body">
                                                                                <h3>Setting up the tools</h3>
                                                                                <p> There are three main tool that are absolutely necessary for our work</p>
                                                                                <ol>
                                                                                        <li>A parser for GFA files. This will be <a href="https://github.com/chfi/rs-gfa"> gfa-rust</a>  </li>
                                                                                        <li>A <a href="https://github.com/jltsiren/gbwt"> GBWT </a> implementation </li>
                                                                                        <li>A programming language with simplicity and a powerful ffi. Being a lisp programmer, my chose the <a href="https://racket-lang.org/">racket programming language </a> </li>
                                                                                </ol>

                                                                        </div>

                                                                        <p>Each tool needs at least a little bit of setup/preparation, before is integrated and is useful.</p>

                                                                        <section class="section">
                                                                                <h1 class="title">Exporting a GFA parser</h1>
                                                                            This is the easiest part of the three. In order to use the rust-gfa package from racket we need to
                                                                            export it to a standard library, like a dynamic c library. This is reflected to a  single function</br>
                                                                            <code>  consume_gfs_file (pointer_path:  *const c_char )  -> CStringArray </code>
                                                                            which is then consumed from racket easily:
                                                                            <br>
                                                                           First we define  a racket struct to hold the result of the consumed function
                                                                           <br>
                                                                           <code> (define-cstruct _CStringArray ([data _pointer] [size _int])) </code>
                                                                           <br>
                                                                           Then we use the racket ffi :
                                                                           <br>
                                                                           <code>   (define consume-gfs-file ... (_fun _pointer ->  _CStringArray))) </code>
                                                                           <br>
                                                                           The resulting function takes a bytestring and returns a _CStringArray.
                                                                           More details can be found to the wrappers repository.
                                                                        </section>

                                                                        <section class="section">

                                                                                <h1 class="title">The GBWT library</h1>
                                                                                <section class="section">
                                                                                        <h1 class="title">Installing </h1>
                                                                                        First we have to compile the GBWT library. It turns out that there are some issues, and the
                                                                                        Readme might be outdated. First clone the repository recursively in order to force the
                                                                                        custom version of sdsl to also clone it self. Second it seems that some flags are missing from the
                                                                                        CMakeLists.txt.
                                                                                        The location of cmake and sdsl source dirs
                                                                                        and the fPIC flag,  necessary since we want to generate dynamic libraries

                                                                                        <br>
                                                                                        I solved this by inserting the following flags:
                                                                                        <br>
                                                                                        <code> set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -O3 -g -fPIC") </code>
                                                                                        <br>
                                                                                        <code> set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O3 -g -fPIC") </code>
                                                                                        <br>
                                                                                        <code> set(CMAKE_SOURCE_DIR  ./src) </code>
                                                                                        <br>
                                                                                        <code> set(SDSL_SOURCE_DIR ./deps/sdsl-lite) </code>
                                                                                        <br>
                                                                                        <code> SOURCE_DIR "${PROJECT_SOURCE_DIR}/deps/sdsl-lite" </code>
                                                                                        <br>
                                                                                        Then followed the rest of the instructions and run  ./install.sh

                                                                                </section>

                                                                                <section>
                                                                                        <h1 class="title">Wrapping </h1>
                                                                                        This is the most tedious part. There are some tools that are generated when we compile the gbwt
                                                                                        library, but they do not provide a stdout, they output directly to files, which is inconvenient.
                                                                                        Since  this is a C++ library, without any exports by design, We have to wrap all the functions to
                                                                                        C equivalent and create a library which can be accessed by ffi
                                                                                        This is done on the gbwt-wrapper project. This project also includes  libgbwt.a    libsdsl.a
                                                                                        precompiled as per the instructions in the previous section. The script build.script should be enough to produce
                                                                                        a dynamic library libgbwtwrapper.so.
                                                                                        All GBWT methods have been replaced by  C functions that  accept a pointer to a GBWT object, as defined in
                                                                                        gbwt library and then  call internally the method.
                                                                                        Most of the functions have been exported, there is some minor work to be done namely exporting template functions
                                                                                        The list of expoerted methods is in the projects single header file

                                                                                </section>

                                                                        </section >
                                                                </div>
                                                        </div>

                                                </div>

                        </section>
                                        </div>
                                        <script async type="text/javascript" src="../js/bulma.js"></script>
                <script src='https://cdnjs.cloudflare.com/ajax/libs/overlayscrollbars/1.9.1/js/OverlayScrollbars.min.js'></script>
                <script>
                        document.addEventListener("DOMContentLoaded", function() {
                                                        //The first argument are the elements to which the plugin shall be initialized
                                                        //The second argument has to be at least a empty object or a object with your desired options
                                                        OverlayScrollbars(document.querySelectorAll("body"), { });
                                                });
                </script>
        </body>

</html>
